class Solution:
    def scheduleCourse(self, courses: List[List[int]]) -> int:
        
        courses.sort(key= lambda c:c[1])
        currentTotalTime = count = 0
        maxheap = []
        for duration, lastday in courses:
            if currentTotalTime + duration <= lastday:
                currentTotalTime += duration
                heapq.heappush(maxheap, (-duration))
                count += 1
            else:   # swap
                if maxheap and -maxheap[0] > duration:
                    npre_max_cost = heapq.heappop(maxheap)
                    currentTotalTime = currentTotalTime + npre_max_cost + duration
                    heapq.heappush(maxheap, -duration)
                                
        return count
